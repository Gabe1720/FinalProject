<!DOCTYPE html>
<html lang="en">
<head>
    <title>Movie Details</title>
    <link rel="stylesheet" href="moviestyle.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <img src="./theatertemplate.jpg" alt="Movie Screen">  
    <div id="movie-details">
        <!-- Movie details will be displayed here -->
    </div>
    <h4> 
	<p> "Where can I watch it?" </p>
	<!-- Streaming info - port in streaming platforms and their corresponding links from a database into an unordered list-->
	<ul> </ul>
    </h4>
    <!-- Registered user restricted functionalities -->
    <button type="button">Favorite</button>
	<!-- Add favorite functionality -->
    <button type="button">Rate</button>
	<!-- Add user rating functionality -->
    <button type="button">Comments</button>
	<!-- Add comment functionality -->
		<!-- Determine if comments should be displayed of this page or a separate one-->
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const movieId = urlParams.get('id');
        fetch("./Database_files/movies_metadata.csv/movies_metadata.csv")
            .then(response => response.text())
            .then(data => {
                // Parse CSV data
                const rows = data.split('\n');
                const headers = rows[0].split(',');
                const movies = [];
                
                for (let i = 1; i < rows.length; i++) {
                    const rowData = rows[i].split(',');
                    const movie = {};
                    
                    for (let j = 0; j < headers.length; j++) {
                        movie[headers[j]] = rowData[j];
                    }
                    
                    movies.push(movie);
                    console.log(movie);
                }
                
                // Display movie data
                const movieDetails = document.getElementById('movie-details');

                movieDetails.innerHTML = `
                    <h1>${movies[movieId].title}</h1>
                    <h2>
			<p>Budget: ${movies[movieId].budget}</p>
			<br> </br>
                    	<p>Release Date: ${movies[movieId].release_date}</p>
                    	<br> </br>
			<p>Rating: ${movies[movieId].vote_average}</p>
		    </h2>
		    <h3> 
			 <a href="./index.html">Return to List</a>
		    </h3>
                `;                
            })
            .catch(error => console.error('Error:', error));
    </script>
</body>
</html>
